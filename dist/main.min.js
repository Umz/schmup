(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/seanodonohue/myProjects/schmup-prototype/src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'schmup-game');

var width = 800;
var height = 600;

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game'
}



game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

},{"./states/boot":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/boot.js","./states/game":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/game.js","./states/menu":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/menu.js","./states/preloader":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/preloader.js","./states/splash":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/splash.js","./utils":"/Users/seanodonohue/myProjects/schmup-prototype/src/js/utils.js"}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  800;
      this.game.scale.minHeight = 600;
      this.game.scale.maxWidth = 800;
      this.game.scale.maxHeight = 600;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/game.js":[function(require,module,exports){
'use strict';
var player;

var playerShields;
var gameOver;

var score = 0;
var scoreText;

var enemies;
var enemyOptions;
var droneScouts;
var droneFighters;
var droneBombers;
var enemyReleaseCounter = 0;

var starfield;

var explosions;
var bullets;
var firingSpeed = 10; // higher = slower
var bulletCounter = firingSpeed;

var cursors;
var fireButton;

var ship = {
  acceleration: 600,
  drag: 350,
  maxSpeed: 400
};

var size = {
  xSmall: 0.4,
  small: 0.5,
  medium: 0.75,
  large: 1,
  xLarge: 1.25,
  miniBoss: 1.5,
  boss: 2
};

var shipTrail;

var Game = function() {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {

  create: function() {
    var game = this;

    //  The scrolling starfield background
    starfield = game.add.tileSprite(0, 0, 800, 600, 'starfield');

    // The player's ship
    player = game.add.sprite(400, 500, 'ship');
    game.physics.arcade.enable(player);
    player.events.onKilled.add(function() {
      shipTrail.kill();
    });

    // Set ship physics
    player.body
      .maxVelocity.setTo(ship.maxSpeed, ship.maxSpeed);
    player.body
      .drag.setTo(ship.drag, ship.drag);
    player.anchor.setTo(0.5, 0.5);

    // Set ship trail emitter
    shipTrail = game.add.emitter(player.x, player.y + 40, 400);
    shipTrail.width = 10;
    shipTrail.makeParticles('plasma');
    shipTrail.setXSpeed(30, -30);
    shipTrail.setYSpeed(200, 180);
    shipTrail.setRotation(50, -50);
    shipTrail.setAlpha(1, 0.01, 800);
    shipTrail.setScale(0.05, 0.4, 0.05, 0.4, 2000, Phaser.Easing.Quintic.Out);
    shipTrail.start(false, 5000, 10);

    // Set controls
    cursors = game.input.keyboard.createCursorKeys();
    fireButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);

    // Creating enemies groups
    droneScouts = game.add.group();
    droneFighters = game.add.group();
    droneBombers = game.add.group();
    enemies = [
      droneScouts,
      droneFighters,
      droneBombers
    ];

    // Default enemy configuration
    enemies.forEach(function(group) {
      configureEnemies(group);
    });

    // Enemies -- Drone Scouts
    droneScouts.createMultiple(50, 'droneScout');
    droneScouts.minWaveTiming = 140;
    droneScouts.maxWaveTiming = 380;
    droneScouts.minWaveNumber = 3;
    droneScouts.maxWaveNumber = 5;
    droneScouts.forEach(function(enemy) {
      enemy.damageAmount = 10;
      enemy.level = 2;
      enemy.speed = game.randomIntegerFrom(250, 450);
      enemy.drift = 30;
      enemy.drag = game.randomIntegerFrom(100, 200);
      enemy.minX = 50;
      enemy.maxX = 750;
      enemy.scale.x = size.xSmall;
      enemy.scale.y = size.xSmall;
    });

    // Enemies - Drone Fighters
    droneFighters.createMultiple(10, 'droneFighter');
    droneFighters.minWaveTiming = 190;
    droneFighters.maxWaveTiming = 500;
    droneFighters.minWaveNumber = 2;
    droneFighters.maxWaveNumber = 4;
    droneFighters.forEach(function(enemy) {
      enemy.damageAmount = 25;
      enemy.level = 3;
      enemy.speed = game.randomIntegerFrom(100, 400);
      enemy.drift = game.randomIntegerFrom(200, 300);
      enemy.drag = 50;
      enemy.minX = 100;
      enemy.maxX = 700;
      enemy.scale.x = size.medium;
      enemy.scale.y = size.medium;
    });

    // Enemies = Drone Bombers
    droneBombers.createMultiple(5, 'droneBomber');
    droneBombers.minWaveTiming = 500;
    droneBombers.maxWaveTiming = 600;
    droneBombers.minWaveNumber = 1;
    droneBombers.maxWaveNumber = 2;
    droneBombers.forEach(function(enemy) {
      enemy.damageAmount = 50;
      enemy.level = 4;
      enemy.speed = 100;
      enemy.drift = 5;
      enemy.drag = 5;
      enemy.minX = 250;
      enemy.maxX = 650;
      enemy.scale.x = size.large;
      enemy.scale.y = size.large;
    });

    function configureEnemies(group) {
      group.physicsBodyType = Phaser.Physics.ARCADE;
      group.enableBody = true;
      group.setAll('anchor.x', 0.5);
      group.setAll('anchor.y', 0.5);
      group.setAll('angle', 180);
      group.setAll('outOfBoundsKill', true);
      group.setAll('checkWorldBounds', true);
    }


    // Unused as of right now.
    function setEnemyAttributes(enemy, options) {
      options = options || {};
      game.physics.enable(enemy, Phaser.Physics.ARCADE);
      for (attr in options) {
        enemy[attr] = options[attr];
      }
    }

    game.launchEnemies(game.randomIntegerFrom(3, 5), droneScouts);

    // The bullet group
    bullets = game.add.group();
    bullets.enableBody = true;
    bullets.physicsBodyType = Phaser.Physics.ARCADE;
    bullets.createMultiple(15, 'bullet');
    bullets.setAll('anchor.x', 0.5);
    bullets.setAll('anchor.y', 1);
    bullets.setAll('outOfBoundsKill', true);
    bullets.setAll('checkWorldBounds', true);

    // Explosion group
    explosions = game.add.group();
    explosions.enableBody = true;
    explosions.physicsBodyType = Phaser.Physics.ARCADE;
    explosions.createMultiple(30, 'explosion');
    explosions.setAll('anchor.x', 0.5);
    explosions.setAll('anchor.y', 0.5);
    explosions.forEach(function(explosion) {
      explosion.animations.add('explosion');
    });

    //Ship HUD and stats
    player.health = 100;
    playerShields = game.add.bitmapText(game.world.width - 250, 10, 'spacefont', '' + player.health + '%', 20);
    playerShields.render = function() {
      playerShields.text = 'Shields: ' + Math.max(player.health, 0) + '%';
    };
    playerShields.render();

    // Score
    scoreText = game.add.bitmapText(10, 10, 'spacefont', '', 20);
    scoreText.render = function() {
      scoreText.text = 'Score: ' + score;
    };
    scoreText.render();

    // Messages
    gameOver = game.add.bitmapText(game.world.centerX, game.world.centerY, 'spacefont', 'GAME OVER!', 50);
    gameOver.x = gameOver.x - gameOver.textWidth / 2;
    gameOver.y = gameOver.y - gameOver.textHeight / 3;
    gameOver.visible = false;

  },

  update: function() {
    var game = this;

    starfield.tilePosition.y += 2;
    enemyReleaseCounter++;

    enemies.forEach(function(enemy) {
      checkWaveTimer(enemy);
      launchNewWaves(enemy);

      function checkWaveTimer(enemy) {
        if (!enemy.waveTimer) {
          enemy.waveTimer =
            roundToNearestTen(
              game.randomIntegerFrom(
                enemy.minWaveTiming,
                enemy.maxWaveTiming
              ));
        }

        function roundToNearestTen(num) {
          return Math.ceil(num / 10) * 10;
        }
      }

      function launchNewWaves(enemy) {
        if (enemyReleaseCounter % enemy.waveTimer === 0) {
          game.launchEnemies(
            game.randomIntegerFrom(
              enemy.minWaveNumber,
              enemy.maxWaveNumber),
            enemy);
          console.log("Wave launched?!");
          enemy.waveTimer = null;
        }
      }
    });

    checkCollisions();
    checkForGameOver();

    // Ship movement logic
    player.body.acceleration.x = 0;

    if (cursors.left.isDown) {
      player.body.acceleration.x = -ship.acceleration;
    } else if (cursors.right.isDown) {
      player.body.acceleration.x = ship.acceleration;
    }

    if (player.alive && fireButton.isDown) {
      fireBullet();
    }

    // TODO: Refactor to be DRY
    if (player.x > 750) {
      player.x = 750;
      player.body.acceleration.x = 0;
    }
    if (player.x < 50) {
      player.x = 50;
      player.body.acceleration.x = 0;
    }

    // Ship banking logic
    var bank = player.body.velocity.x / ship.maxSpeed;
    player.scale.x = 1 - Math.abs(bank) / 4;
    player.angle = bank * 5;

    shipTrail.x = player.x;

    function checkForGameOver() {
      if (!player.alive && gameOver.visible == false) {
        gameOver.visible = true;
        gameOver.alpha = 0;
        var fadeInGameOver = game.add.tween(gameOver);
        fadeInGameOver.to({
          alpha: 1
        }, 1000, Phaser.Easing.Quintic.Out);
        fadeInGameOver.onComplete.add(setResetHandlers);
        fadeInGameOver.start();

        function setResetHandlers() {
          var tapRestart = game.input.onTap.addOnce(_restart, game);
          var spaceRestart = fireButton.onDown.addOnce(_restart, game);

          function _restart() {
            tapRestart.detach();
            spaceRestart.detach();
            game.restart();
          }
        }
      }
    }

    function checkCollisions() {
      enemies.forEach(function(group) {
        game.physics.arcade.overlap(player, group, shipCollide, null, game);
        game.physics.arcade.overlap(bullets, group, hitEnemy, null, game);
      });
    }

    function fireBullet() {
      var bullet = bullets.getFirstExists(false);
      var bulletSpeed = 400;

      if (bulletCounter > firingSpeed) {

        bulletCounter = 0;

        // Bullet physics
        if (bullet) {
          bullet.reset(player.x, player.y - 25);

          bullet.body.velocity.y = -200;
          bullet.body.velocity.x += player.body.velocity.x / 5;
        }
      }
      bulletCounter++;
    }

    function shipCollide(player, enemy) {
      var explosion = explosions.getFirstExists(false);
      explosion.reset(enemy.body.x + enemy.body.halfWidth, enemy.body.y + enemy.body.halfHeight);
      explosion.body.velocity.y = enemy.body.velocity.y;
      explosion.alpha = 0.7;
      explosion.play('explosion', 30, false, true);
      enemy.kill();

      player.damage(enemy.damageAmount);
      playerShields.render();
      addPointsForKilling(enemy);
    }

    function hitEnemy(bullet, enemy) {
      var explosion = explosions.getFirstExists(false);
      explosion.reset(enemy.body.x + enemy.body.halfWidth, enemy.body.y + enemy.body.halfHeight);
      explosion.body.velocity.y = enemy.body.velocity.y;
      explosion.alpha = 0.7;
      explosion.play('explosion', 30, false, true);
      enemy.kill();
      bullet.kill();
      addPointsForKilling(enemy);
    }

    function addPointsForKilling(enemy) {
      score += enemy.damageAmount * enemy.level;
      scoreText.render();
    }

  },

  launchEnemies: function(quantity, enemyGroup) {
    var game = this;
    for (var i = 0; i < quantity; i++) {
      launchEnemy();
    }

    function launchEnemy() {
      var enemy = enemyGroup.getFirstExists(false);
      if (enemy) {
        var enemyLocation = game.randomIntegerFrom(
          enemy.minX, enemy.maxX);
        enemy.reset(enemyLocation, -20);
        enemy.body.velocity.x = game.randomIntegerFrom(-enemy.drift, enemy.drift);
        enemy.body.velocity.y = enemy.speed;
        enemy.body.drag.x = enemy.drag;
      }
    }
  },

  restart: function() {
    droneScouts.callAll('kill');
    enemyReleaseCounter = 0;
    player.revive();
    player.health = 100;
    playerShields.render();
    score = 0;
    scoreText.render();
    gameOver.visible = false;
  },

  // Utility functions
  randomIntegerFrom: function(min, max) {
    return Math.floor(Math.random() * (max - min) + min + 1);
  },

  onInputDown: function() {
    this.game.state.start('Menu');
  }
};
},{}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
  this.subtitle = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    this.text = this.add.bitmapText(x - 300, y - 200, 'spacefont', "Click to Start", 50);
    this.subtitle = this.add.bitmapText(x - 300, y - 100, 'spacefont', "Arrow keys to move, Space to fire", 20);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

},{}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/preloader.js":[function(require,module,exports){
var Preloader = function(game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;


Preloader.prototype = {

  preload: function() {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.physics.startSystem(Phaser.Physics.ARCADE);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('starfield', 'assets/starfield.png');
    this.load.image('ship', 'assets/player.png');
    this.load.image('plasma', 'assets/bluePlasma.png');
    this.load.image('laser', 'assets/blueLaser.png');
    this.load.image('bullet', 'assets/blueBullet.png');
    this.load.image('droneScout', 'assets/droneScout.png');
    this.load.image('droneFighter', 'assets/droneFighter.png');
    this.load.image('droneBomber', 'assets/droneBomber.png');
    this.load.image('enemyTrail', 'assets/enemyTrail.png');
    this.load.spritesheet('explosion', 'assets/explosion.png', 128, 128);
    this.load.bitmapFont('spacefont', 'assets/spacefont/spacefont.png', 'assets/spacefont/spacefont.fnt');
  },

  create: function() {
    this.asset.cropEnabled = false;
  },

  update: function() {
    if (!!this.ready) {
      this.game.state.start('Menu');
    }
  },

  onLoadComplete: function() {
    this.ready = true;
  }
};
},{}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"/Users/seanodonohue/myProjects/schmup-prototype/src/js/utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    }
};

module.exports = Utils;
},{}]},{},["/Users/seanodonohue/myProjects/schmup-prototype/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9zdGF0ZXMvYm9vdC5qcyIsInNyYy9qcy9zdGF0ZXMvZ2FtZS5qcyIsInNyYy9qcy9zdGF0ZXMvbWVudS5qcyIsInNyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIiwic3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDYwMCwgUGhhc2VyLkFVVE8sICdzY2htdXAtZ2FtZScpO1xuXG52YXIgd2lkdGggPSA4MDA7XG52YXIgaGVpZ2h0ID0gNjAwO1xuXG53aW5kb3cuVXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG53aW5kb3cucGxheWVyU3RhdGUgPSB7XG4gICAgY3VycmVudExldmVsOiAnR2FtZSdcbn1cblxuXG5cbmdhbWUuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZSgnLi9zdGF0ZXMvYm9vdCcpKTtcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XG5nYW1lLnN0YXRlLmFkZCgnUHJlbG9hZGVyJywgcmVxdWlyZSgnLi9zdGF0ZXMvcHJlbG9hZGVyJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ01lbnUnLCByZXF1aXJlKCcuL3N0YXRlcy9tZW51JykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xuXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHt9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJvb3Q7XG5cbkJvb3QucHJvdG90eXBlID0ge1xuXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XG5cbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLmdhbWUuc3RhZ2Uuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSAgODAwO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbkhlaWdodCA9IDYwMDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhXaWR0aCA9IDgwMDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhIZWlnaHQgPSA2MDA7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZm9yY2VMYW5kc2NhcGUgPSB0cnVlO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIHBsYXllcjtcblxudmFyIHBsYXllclNoaWVsZHM7XG52YXIgZ2FtZU92ZXI7XG5cbnZhciBzY29yZSA9IDA7XG52YXIgc2NvcmVUZXh0O1xuXG52YXIgZW5lbWllcztcbnZhciBlbmVteU9wdGlvbnM7XG52YXIgZHJvbmVTY291dHM7XG52YXIgZHJvbmVGaWdodGVycztcbnZhciBkcm9uZUJvbWJlcnM7XG52YXIgZW5lbXlSZWxlYXNlQ291bnRlciA9IDA7XG5cbnZhciBzdGFyZmllbGQ7XG5cbnZhciBleHBsb3Npb25zO1xudmFyIGJ1bGxldHM7XG52YXIgZmlyaW5nU3BlZWQgPSAxMDsgLy8gaGlnaGVyID0gc2xvd2VyXG52YXIgYnVsbGV0Q291bnRlciA9IGZpcmluZ1NwZWVkO1xuXG52YXIgY3Vyc29ycztcbnZhciBmaXJlQnV0dG9uO1xuXG52YXIgc2hpcCA9IHtcbiAgYWNjZWxlcmF0aW9uOiA2MDAsXG4gIGRyYWc6IDM1MCxcbiAgbWF4U3BlZWQ6IDQwMFxufTtcblxudmFyIHNpemUgPSB7XG4gIHhTbWFsbDogMC40LFxuICBzbWFsbDogMC41LFxuICBtZWRpdW06IDAuNzUsXG4gIGxhcmdlOiAxLFxuICB4TGFyZ2U6IDEuMjUsXG4gIG1pbmlCb3NzOiAxLjUsXG4gIGJvc3M6IDJcbn07XG5cbnZhciBzaGlwVHJhaWw7XG5cbnZhciBHYW1lID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG5cbkdhbWUucHJvdG90eXBlID0ge1xuXG4gIGNyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGdhbWUgPSB0aGlzO1xuXG4gICAgLy8gIFRoZSBzY3JvbGxpbmcgc3RhcmZpZWxkIGJhY2tncm91bmRcbiAgICBzdGFyZmllbGQgPSBnYW1lLmFkZC50aWxlU3ByaXRlKDAsIDAsIDgwMCwgNjAwLCAnc3RhcmZpZWxkJyk7XG5cbiAgICAvLyBUaGUgcGxheWVyJ3Mgc2hpcFxuICAgIHBsYXllciA9IGdhbWUuYWRkLnNwcml0ZSg0MDAsIDUwMCwgJ3NoaXAnKTtcbiAgICBnYW1lLnBoeXNpY3MuYXJjYWRlLmVuYWJsZShwbGF5ZXIpO1xuICAgIHBsYXllci5ldmVudHMub25LaWxsZWQuYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgc2hpcFRyYWlsLmtpbGwoKTtcbiAgICB9KTtcblxuICAgIC8vIFNldCBzaGlwIHBoeXNpY3NcbiAgICBwbGF5ZXIuYm9keVxuICAgICAgLm1heFZlbG9jaXR5LnNldFRvKHNoaXAubWF4U3BlZWQsIHNoaXAubWF4U3BlZWQpO1xuICAgIHBsYXllci5ib2R5XG4gICAgICAuZHJhZy5zZXRUbyhzaGlwLmRyYWcsIHNoaXAuZHJhZyk7XG4gICAgcGxheWVyLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG5cbiAgICAvLyBTZXQgc2hpcCB0cmFpbCBlbWl0dGVyXG4gICAgc2hpcFRyYWlsID0gZ2FtZS5hZGQuZW1pdHRlcihwbGF5ZXIueCwgcGxheWVyLnkgKyA0MCwgNDAwKTtcbiAgICBzaGlwVHJhaWwud2lkdGggPSAxMDtcbiAgICBzaGlwVHJhaWwubWFrZVBhcnRpY2xlcygncGxhc21hJyk7XG4gICAgc2hpcFRyYWlsLnNldFhTcGVlZCgzMCwgLTMwKTtcbiAgICBzaGlwVHJhaWwuc2V0WVNwZWVkKDIwMCwgMTgwKTtcbiAgICBzaGlwVHJhaWwuc2V0Um90YXRpb24oNTAsIC01MCk7XG4gICAgc2hpcFRyYWlsLnNldEFscGhhKDEsIDAuMDEsIDgwMCk7XG4gICAgc2hpcFRyYWlsLnNldFNjYWxlKDAuMDUsIDAuNCwgMC4wNSwgMC40LCAyMDAwLCBQaGFzZXIuRWFzaW5nLlF1aW50aWMuT3V0KTtcbiAgICBzaGlwVHJhaWwuc3RhcnQoZmFsc2UsIDUwMDAsIDEwKTtcblxuICAgIC8vIFNldCBjb250cm9sc1xuICAgIGN1cnNvcnMgPSBnYW1lLmlucHV0LmtleWJvYXJkLmNyZWF0ZUN1cnNvcktleXMoKTtcbiAgICBmaXJlQnV0dG9uID0gZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlNQQUNFQkFSKTtcblxuICAgIC8vIENyZWF0aW5nIGVuZW1pZXMgZ3JvdXBzXG4gICAgZHJvbmVTY291dHMgPSBnYW1lLmFkZC5ncm91cCgpO1xuICAgIGRyb25lRmlnaHRlcnMgPSBnYW1lLmFkZC5ncm91cCgpO1xuICAgIGRyb25lQm9tYmVycyA9IGdhbWUuYWRkLmdyb3VwKCk7XG4gICAgZW5lbWllcyA9IFtcbiAgICAgIGRyb25lU2NvdXRzLFxuICAgICAgZHJvbmVGaWdodGVycyxcbiAgICAgIGRyb25lQm9tYmVyc1xuICAgIF07XG5cbiAgICAvLyBEZWZhdWx0IGVuZW15IGNvbmZpZ3VyYXRpb25cbiAgICBlbmVtaWVzLmZvckVhY2goZnVuY3Rpb24oZ3JvdXApIHtcbiAgICAgIGNvbmZpZ3VyZUVuZW1pZXMoZ3JvdXApO1xuICAgIH0pO1xuXG4gICAgLy8gRW5lbWllcyAtLSBEcm9uZSBTY291dHNcbiAgICBkcm9uZVNjb3V0cy5jcmVhdGVNdWx0aXBsZSg1MCwgJ2Ryb25lU2NvdXQnKTtcbiAgICBkcm9uZVNjb3V0cy5taW5XYXZlVGltaW5nID0gMTQwO1xuICAgIGRyb25lU2NvdXRzLm1heFdhdmVUaW1pbmcgPSAzODA7XG4gICAgZHJvbmVTY291dHMubWluV2F2ZU51bWJlciA9IDM7XG4gICAgZHJvbmVTY291dHMubWF4V2F2ZU51bWJlciA9IDU7XG4gICAgZHJvbmVTY291dHMuZm9yRWFjaChmdW5jdGlvbihlbmVteSkge1xuICAgICAgZW5lbXkuZGFtYWdlQW1vdW50ID0gMTA7XG4gICAgICBlbmVteS5sZXZlbCA9IDI7XG4gICAgICBlbmVteS5zcGVlZCA9IGdhbWUucmFuZG9tSW50ZWdlckZyb20oMjUwLCA0NTApO1xuICAgICAgZW5lbXkuZHJpZnQgPSAzMDtcbiAgICAgIGVuZW15LmRyYWcgPSBnYW1lLnJhbmRvbUludGVnZXJGcm9tKDEwMCwgMjAwKTtcbiAgICAgIGVuZW15Lm1pblggPSA1MDtcbiAgICAgIGVuZW15Lm1heFggPSA3NTA7XG4gICAgICBlbmVteS5zY2FsZS54ID0gc2l6ZS54U21hbGw7XG4gICAgICBlbmVteS5zY2FsZS55ID0gc2l6ZS54U21hbGw7XG4gICAgfSk7XG5cbiAgICAvLyBFbmVtaWVzIC0gRHJvbmUgRmlnaHRlcnNcbiAgICBkcm9uZUZpZ2h0ZXJzLmNyZWF0ZU11bHRpcGxlKDEwLCAnZHJvbmVGaWdodGVyJyk7XG4gICAgZHJvbmVGaWdodGVycy5taW5XYXZlVGltaW5nID0gMTkwO1xuICAgIGRyb25lRmlnaHRlcnMubWF4V2F2ZVRpbWluZyA9IDUwMDtcbiAgICBkcm9uZUZpZ2h0ZXJzLm1pbldhdmVOdW1iZXIgPSAyO1xuICAgIGRyb25lRmlnaHRlcnMubWF4V2F2ZU51bWJlciA9IDQ7XG4gICAgZHJvbmVGaWdodGVycy5mb3JFYWNoKGZ1bmN0aW9uKGVuZW15KSB7XG4gICAgICBlbmVteS5kYW1hZ2VBbW91bnQgPSAyNTtcbiAgICAgIGVuZW15LmxldmVsID0gMztcbiAgICAgIGVuZW15LnNwZWVkID0gZ2FtZS5yYW5kb21JbnRlZ2VyRnJvbSgxMDAsIDQwMCk7XG4gICAgICBlbmVteS5kcmlmdCA9IGdhbWUucmFuZG9tSW50ZWdlckZyb20oMjAwLCAzMDApO1xuICAgICAgZW5lbXkuZHJhZyA9IDUwO1xuICAgICAgZW5lbXkubWluWCA9IDEwMDtcbiAgICAgIGVuZW15Lm1heFggPSA3MDA7XG4gICAgICBlbmVteS5zY2FsZS54ID0gc2l6ZS5tZWRpdW07XG4gICAgICBlbmVteS5zY2FsZS55ID0gc2l6ZS5tZWRpdW07XG4gICAgfSk7XG5cbiAgICAvLyBFbmVtaWVzID0gRHJvbmUgQm9tYmVyc1xuICAgIGRyb25lQm9tYmVycy5jcmVhdGVNdWx0aXBsZSg1LCAnZHJvbmVCb21iZXInKTtcbiAgICBkcm9uZUJvbWJlcnMubWluV2F2ZVRpbWluZyA9IDUwMDtcbiAgICBkcm9uZUJvbWJlcnMubWF4V2F2ZVRpbWluZyA9IDYwMDtcbiAgICBkcm9uZUJvbWJlcnMubWluV2F2ZU51bWJlciA9IDE7XG4gICAgZHJvbmVCb21iZXJzLm1heFdhdmVOdW1iZXIgPSAyO1xuICAgIGRyb25lQm9tYmVycy5mb3JFYWNoKGZ1bmN0aW9uKGVuZW15KSB7XG4gICAgICBlbmVteS5kYW1hZ2VBbW91bnQgPSA1MDtcbiAgICAgIGVuZW15LmxldmVsID0gNDtcbiAgICAgIGVuZW15LnNwZWVkID0gMTAwO1xuICAgICAgZW5lbXkuZHJpZnQgPSA1O1xuICAgICAgZW5lbXkuZHJhZyA9IDU7XG4gICAgICBlbmVteS5taW5YID0gMjUwO1xuICAgICAgZW5lbXkubWF4WCA9IDY1MDtcbiAgICAgIGVuZW15LnNjYWxlLnggPSBzaXplLmxhcmdlO1xuICAgICAgZW5lbXkuc2NhbGUueSA9IHNpemUubGFyZ2U7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBjb25maWd1cmVFbmVtaWVzKGdyb3VwKSB7XG4gICAgICBncm91cC5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XG4gICAgICBncm91cC5lbmFibGVCb2R5ID0gdHJ1ZTtcbiAgICAgIGdyb3VwLnNldEFsbCgnYW5jaG9yLngnLCAwLjUpO1xuICAgICAgZ3JvdXAuc2V0QWxsKCdhbmNob3IueScsIDAuNSk7XG4gICAgICBncm91cC5zZXRBbGwoJ2FuZ2xlJywgMTgwKTtcbiAgICAgIGdyb3VwLnNldEFsbCgnb3V0T2ZCb3VuZHNLaWxsJywgdHJ1ZSk7XG4gICAgICBncm91cC5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcbiAgICB9XG5cblxuICAgIC8vIFVudXNlZCBhcyBvZiByaWdodCBub3cuXG4gICAgZnVuY3Rpb24gc2V0RW5lbXlBdHRyaWJ1dGVzKGVuZW15LCBvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgIGdhbWUucGh5c2ljcy5lbmFibGUoZW5lbXksIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG4gICAgICBmb3IgKGF0dHIgaW4gb3B0aW9ucykge1xuICAgICAgICBlbmVteVthdHRyXSA9IG9wdGlvbnNbYXR0cl07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2FtZS5sYXVuY2hFbmVtaWVzKGdhbWUucmFuZG9tSW50ZWdlckZyb20oMywgNSksIGRyb25lU2NvdXRzKTtcblxuICAgIC8vIFRoZSBidWxsZXQgZ3JvdXBcbiAgICBidWxsZXRzID0gZ2FtZS5hZGQuZ3JvdXAoKTtcbiAgICBidWxsZXRzLmVuYWJsZUJvZHkgPSB0cnVlO1xuICAgIGJ1bGxldHMucGh5c2ljc0JvZHlUeXBlID0gUGhhc2VyLlBoeXNpY3MuQVJDQURFO1xuICAgIGJ1bGxldHMuY3JlYXRlTXVsdGlwbGUoMTUsICdidWxsZXQnKTtcbiAgICBidWxsZXRzLnNldEFsbCgnYW5jaG9yLngnLCAwLjUpO1xuICAgIGJ1bGxldHMuc2V0QWxsKCdhbmNob3IueScsIDEpO1xuICAgIGJ1bGxldHMuc2V0QWxsKCdvdXRPZkJvdW5kc0tpbGwnLCB0cnVlKTtcbiAgICBidWxsZXRzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpO1xuXG4gICAgLy8gRXhwbG9zaW9uIGdyb3VwXG4gICAgZXhwbG9zaW9ucyA9IGdhbWUuYWRkLmdyb3VwKCk7XG4gICAgZXhwbG9zaW9ucy5lbmFibGVCb2R5ID0gdHJ1ZTtcbiAgICBleHBsb3Npb25zLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcbiAgICBleHBsb3Npb25zLmNyZWF0ZU11bHRpcGxlKDMwLCAnZXhwbG9zaW9uJyk7XG4gICAgZXhwbG9zaW9ucy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcbiAgICBleHBsb3Npb25zLnNldEFsbCgnYW5jaG9yLnknLCAwLjUpO1xuICAgIGV4cGxvc2lvbnMuZm9yRWFjaChmdW5jdGlvbihleHBsb3Npb24pIHtcbiAgICAgIGV4cGxvc2lvbi5hbmltYXRpb25zLmFkZCgnZXhwbG9zaW9uJyk7XG4gICAgfSk7XG5cbiAgICAvL1NoaXAgSFVEIGFuZCBzdGF0c1xuICAgIHBsYXllci5oZWFsdGggPSAxMDA7XG4gICAgcGxheWVyU2hpZWxkcyA9IGdhbWUuYWRkLmJpdG1hcFRleHQoZ2FtZS53b3JsZC53aWR0aCAtIDI1MCwgMTAsICdzcGFjZWZvbnQnLCAnJyArIHBsYXllci5oZWFsdGggKyAnJScsIDIwKTtcbiAgICBwbGF5ZXJTaGllbGRzLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcGxheWVyU2hpZWxkcy50ZXh0ID0gJ1NoaWVsZHM6ICcgKyBNYXRoLm1heChwbGF5ZXIuaGVhbHRoLCAwKSArICclJztcbiAgICB9O1xuICAgIHBsYXllclNoaWVsZHMucmVuZGVyKCk7XG5cbiAgICAvLyBTY29yZVxuICAgIHNjb3JlVGV4dCA9IGdhbWUuYWRkLmJpdG1hcFRleHQoMTAsIDEwLCAnc3BhY2Vmb250JywgJycsIDIwKTtcbiAgICBzY29yZVRleHQucmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICBzY29yZVRleHQudGV4dCA9ICdTY29yZTogJyArIHNjb3JlO1xuICAgIH07XG4gICAgc2NvcmVUZXh0LnJlbmRlcigpO1xuXG4gICAgLy8gTWVzc2FnZXNcbiAgICBnYW1lT3ZlciA9IGdhbWUuYWRkLmJpdG1hcFRleHQoZ2FtZS53b3JsZC5jZW50ZXJYLCBnYW1lLndvcmxkLmNlbnRlclksICdzcGFjZWZvbnQnLCAnR0FNRSBPVkVSIScsIDUwKTtcbiAgICBnYW1lT3Zlci54ID0gZ2FtZU92ZXIueCAtIGdhbWVPdmVyLnRleHRXaWR0aCAvIDI7XG4gICAgZ2FtZU92ZXIueSA9IGdhbWVPdmVyLnkgLSBnYW1lT3Zlci50ZXh0SGVpZ2h0IC8gMztcbiAgICBnYW1lT3Zlci52aXNpYmxlID0gZmFsc2U7XG5cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBnYW1lID0gdGhpcztcblxuICAgIHN0YXJmaWVsZC50aWxlUG9zaXRpb24ueSArPSAyO1xuICAgIGVuZW15UmVsZWFzZUNvdW50ZXIrKztcblxuICAgIGVuZW1pZXMuZm9yRWFjaChmdW5jdGlvbihlbmVteSkge1xuICAgICAgY2hlY2tXYXZlVGltZXIoZW5lbXkpO1xuICAgICAgbGF1bmNoTmV3V2F2ZXMoZW5lbXkpO1xuXG4gICAgICBmdW5jdGlvbiBjaGVja1dhdmVUaW1lcihlbmVteSkge1xuICAgICAgICBpZiAoIWVuZW15LndhdmVUaW1lcikge1xuICAgICAgICAgIGVuZW15LndhdmVUaW1lciA9XG4gICAgICAgICAgICByb3VuZFRvTmVhcmVzdFRlbihcbiAgICAgICAgICAgICAgZ2FtZS5yYW5kb21JbnRlZ2VyRnJvbShcbiAgICAgICAgICAgICAgICBlbmVteS5taW5XYXZlVGltaW5nLFxuICAgICAgICAgICAgICAgIGVuZW15Lm1heFdhdmVUaW1pbmdcbiAgICAgICAgICAgICAgKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByb3VuZFRvTmVhcmVzdFRlbihudW0pIHtcbiAgICAgICAgICByZXR1cm4gTWF0aC5jZWlsKG51bSAvIDEwKSAqIDEwO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGxhdW5jaE5ld1dhdmVzKGVuZW15KSB7XG4gICAgICAgIGlmIChlbmVteVJlbGVhc2VDb3VudGVyICUgZW5lbXkud2F2ZVRpbWVyID09PSAwKSB7XG4gICAgICAgICAgZ2FtZS5sYXVuY2hFbmVtaWVzKFxuICAgICAgICAgICAgZ2FtZS5yYW5kb21JbnRlZ2VyRnJvbShcbiAgICAgICAgICAgICAgZW5lbXkubWluV2F2ZU51bWJlcixcbiAgICAgICAgICAgICAgZW5lbXkubWF4V2F2ZU51bWJlciksXG4gICAgICAgICAgICBlbmVteSk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJXYXZlIGxhdW5jaGVkPyFcIik7XG4gICAgICAgICAgZW5lbXkud2F2ZVRpbWVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY2hlY2tDb2xsaXNpb25zKCk7XG4gICAgY2hlY2tGb3JHYW1lT3ZlcigpO1xuXG4gICAgLy8gU2hpcCBtb3ZlbWVudCBsb2dpY1xuICAgIHBsYXllci5ib2R5LmFjY2VsZXJhdGlvbi54ID0gMDtcblxuICAgIGlmIChjdXJzb3JzLmxlZnQuaXNEb3duKSB7XG4gICAgICBwbGF5ZXIuYm9keS5hY2NlbGVyYXRpb24ueCA9IC1zaGlwLmFjY2VsZXJhdGlvbjtcbiAgICB9IGVsc2UgaWYgKGN1cnNvcnMucmlnaHQuaXNEb3duKSB7XG4gICAgICBwbGF5ZXIuYm9keS5hY2NlbGVyYXRpb24ueCA9IHNoaXAuYWNjZWxlcmF0aW9uO1xuICAgIH1cblxuICAgIGlmIChwbGF5ZXIuYWxpdmUgJiYgZmlyZUJ1dHRvbi5pc0Rvd24pIHtcbiAgICAgIGZpcmVCdWxsZXQoKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBSZWZhY3RvciB0byBiZSBEUllcbiAgICBpZiAocGxheWVyLnggPiA3NTApIHtcbiAgICAgIHBsYXllci54ID0gNzUwO1xuICAgICAgcGxheWVyLmJvZHkuYWNjZWxlcmF0aW9uLnggPSAwO1xuICAgIH1cbiAgICBpZiAocGxheWVyLnggPCA1MCkge1xuICAgICAgcGxheWVyLnggPSA1MDtcbiAgICAgIHBsYXllci5ib2R5LmFjY2VsZXJhdGlvbi54ID0gMDtcbiAgICB9XG5cbiAgICAvLyBTaGlwIGJhbmtpbmcgbG9naWNcbiAgICB2YXIgYmFuayA9IHBsYXllci5ib2R5LnZlbG9jaXR5LnggLyBzaGlwLm1heFNwZWVkO1xuICAgIHBsYXllci5zY2FsZS54ID0gMSAtIE1hdGguYWJzKGJhbmspIC8gNDtcbiAgICBwbGF5ZXIuYW5nbGUgPSBiYW5rICogNTtcblxuICAgIHNoaXBUcmFpbC54ID0gcGxheWVyLng7XG5cbiAgICBmdW5jdGlvbiBjaGVja0ZvckdhbWVPdmVyKCkge1xuICAgICAgaWYgKCFwbGF5ZXIuYWxpdmUgJiYgZ2FtZU92ZXIudmlzaWJsZSA9PSBmYWxzZSkge1xuICAgICAgICBnYW1lT3Zlci52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgZ2FtZU92ZXIuYWxwaGEgPSAwO1xuICAgICAgICB2YXIgZmFkZUluR2FtZU92ZXIgPSBnYW1lLmFkZC50d2VlbihnYW1lT3Zlcik7XG4gICAgICAgIGZhZGVJbkdhbWVPdmVyLnRvKHtcbiAgICAgICAgICBhbHBoYTogMVxuICAgICAgICB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1aW50aWMuT3V0KTtcbiAgICAgICAgZmFkZUluR2FtZU92ZXIub25Db21wbGV0ZS5hZGQoc2V0UmVzZXRIYW5kbGVycyk7XG4gICAgICAgIGZhZGVJbkdhbWVPdmVyLnN0YXJ0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0UmVzZXRIYW5kbGVycygpIHtcbiAgICAgICAgICB2YXIgdGFwUmVzdGFydCA9IGdhbWUuaW5wdXQub25UYXAuYWRkT25jZShfcmVzdGFydCwgZ2FtZSk7XG4gICAgICAgICAgdmFyIHNwYWNlUmVzdGFydCA9IGZpcmVCdXR0b24ub25Eb3duLmFkZE9uY2UoX3Jlc3RhcnQsIGdhbWUpO1xuXG4gICAgICAgICAgZnVuY3Rpb24gX3Jlc3RhcnQoKSB7XG4gICAgICAgICAgICB0YXBSZXN0YXJ0LmRldGFjaCgpO1xuICAgICAgICAgICAgc3BhY2VSZXN0YXJ0LmRldGFjaCgpO1xuICAgICAgICAgICAgZ2FtZS5yZXN0YXJ0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tDb2xsaXNpb25zKCkge1xuICAgICAgZW5lbWllcy5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwKSB7XG4gICAgICAgIGdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcChwbGF5ZXIsIGdyb3VwLCBzaGlwQ29sbGlkZSwgbnVsbCwgZ2FtZSk7XG4gICAgICAgIGdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcChidWxsZXRzLCBncm91cCwgaGl0RW5lbXksIG51bGwsIGdhbWUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlyZUJ1bGxldCgpIHtcbiAgICAgIHZhciBidWxsZXQgPSBidWxsZXRzLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcbiAgICAgIHZhciBidWxsZXRTcGVlZCA9IDQwMDtcblxuICAgICAgaWYgKGJ1bGxldENvdW50ZXIgPiBmaXJpbmdTcGVlZCkge1xuXG4gICAgICAgIGJ1bGxldENvdW50ZXIgPSAwO1xuXG4gICAgICAgIC8vIEJ1bGxldCBwaHlzaWNzXG4gICAgICAgIGlmIChidWxsZXQpIHtcbiAgICAgICAgICBidWxsZXQucmVzZXQocGxheWVyLngsIHBsYXllci55IC0gMjUpO1xuXG4gICAgICAgICAgYnVsbGV0LmJvZHkudmVsb2NpdHkueSA9IC0yMDA7XG4gICAgICAgICAgYnVsbGV0LmJvZHkudmVsb2NpdHkueCArPSBwbGF5ZXIuYm9keS52ZWxvY2l0eS54IC8gNTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYnVsbGV0Q291bnRlcisrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNoaXBDb2xsaWRlKHBsYXllciwgZW5lbXkpIHtcbiAgICAgIHZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcbiAgICAgIGV4cGxvc2lvbi5yZXNldChlbmVteS5ib2R5LnggKyBlbmVteS5ib2R5LmhhbGZXaWR0aCwgZW5lbXkuYm9keS55ICsgZW5lbXkuYm9keS5oYWxmSGVpZ2h0KTtcbiAgICAgIGV4cGxvc2lvbi5ib2R5LnZlbG9jaXR5LnkgPSBlbmVteS5ib2R5LnZlbG9jaXR5Lnk7XG4gICAgICBleHBsb3Npb24uYWxwaGEgPSAwLjc7XG4gICAgICBleHBsb3Npb24ucGxheSgnZXhwbG9zaW9uJywgMzAsIGZhbHNlLCB0cnVlKTtcbiAgICAgIGVuZW15LmtpbGwoKTtcblxuICAgICAgcGxheWVyLmRhbWFnZShlbmVteS5kYW1hZ2VBbW91bnQpO1xuICAgICAgcGxheWVyU2hpZWxkcy5yZW5kZXIoKTtcbiAgICAgIGFkZFBvaW50c0ZvcktpbGxpbmcoZW5lbXkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhpdEVuZW15KGJ1bGxldCwgZW5lbXkpIHtcbiAgICAgIHZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcbiAgICAgIGV4cGxvc2lvbi5yZXNldChlbmVteS5ib2R5LnggKyBlbmVteS5ib2R5LmhhbGZXaWR0aCwgZW5lbXkuYm9keS55ICsgZW5lbXkuYm9keS5oYWxmSGVpZ2h0KTtcbiAgICAgIGV4cGxvc2lvbi5ib2R5LnZlbG9jaXR5LnkgPSBlbmVteS5ib2R5LnZlbG9jaXR5Lnk7XG4gICAgICBleHBsb3Npb24uYWxwaGEgPSAwLjc7XG4gICAgICBleHBsb3Npb24ucGxheSgnZXhwbG9zaW9uJywgMzAsIGZhbHNlLCB0cnVlKTtcbiAgICAgIGVuZW15LmtpbGwoKTtcbiAgICAgIGJ1bGxldC5raWxsKCk7XG4gICAgICBhZGRQb2ludHNGb3JLaWxsaW5nKGVuZW15KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQb2ludHNGb3JLaWxsaW5nKGVuZW15KSB7XG4gICAgICBzY29yZSArPSBlbmVteS5kYW1hZ2VBbW91bnQgKiBlbmVteS5sZXZlbDtcbiAgICAgIHNjb3JlVGV4dC5yZW5kZXIoKTtcbiAgICB9XG5cbiAgfSxcblxuICBsYXVuY2hFbmVtaWVzOiBmdW5jdGlvbihxdWFudGl0eSwgZW5lbXlHcm91cCkge1xuICAgIHZhciBnYW1lID0gdGhpcztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1YW50aXR5OyBpKyspIHtcbiAgICAgIGxhdW5jaEVuZW15KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGF1bmNoRW5lbXkoKSB7XG4gICAgICB2YXIgZW5lbXkgPSBlbmVteUdyb3VwLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcbiAgICAgIGlmIChlbmVteSkge1xuICAgICAgICB2YXIgZW5lbXlMb2NhdGlvbiA9IGdhbWUucmFuZG9tSW50ZWdlckZyb20oXG4gICAgICAgICAgZW5lbXkubWluWCwgZW5lbXkubWF4WCk7XG4gICAgICAgIGVuZW15LnJlc2V0KGVuZW15TG9jYXRpb24sIC0yMCk7XG4gICAgICAgIGVuZW15LmJvZHkudmVsb2NpdHkueCA9IGdhbWUucmFuZG9tSW50ZWdlckZyb20oLWVuZW15LmRyaWZ0LCBlbmVteS5kcmlmdCk7XG4gICAgICAgIGVuZW15LmJvZHkudmVsb2NpdHkueSA9IGVuZW15LnNwZWVkO1xuICAgICAgICBlbmVteS5ib2R5LmRyYWcueCA9IGVuZW15LmRyYWc7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHJlc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgIGRyb25lU2NvdXRzLmNhbGxBbGwoJ2tpbGwnKTtcbiAgICBlbmVteVJlbGVhc2VDb3VudGVyID0gMDtcbiAgICBwbGF5ZXIucmV2aXZlKCk7XG4gICAgcGxheWVyLmhlYWx0aCA9IDEwMDtcbiAgICBwbGF5ZXJTaGllbGRzLnJlbmRlcigpO1xuICAgIHNjb3JlID0gMDtcbiAgICBzY29yZVRleHQucmVuZGVyKCk7XG4gICAgZ2FtZU92ZXIudmlzaWJsZSA9IGZhbHNlO1xuICB9LFxuXG4gIC8vIFV0aWxpdHkgZnVuY3Rpb25zXG4gIHJhbmRvbUludGVnZXJGcm9tOiBmdW5jdGlvbihtaW4sIG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pbiArIDEpO1xuICB9LFxuXG4gIG9uSW5wdXREb3duOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcbiAgfVxufTsiLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy50ZXh0ID0gbnVsbDtcbiAgdGhpcy5zdWJ0aXRsZSA9IG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1lbnU7XG5cbk1lbnUucHJvdG90eXBlID0ge1xuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcbiAgICB2YXIgeSA9IHRoaXMuZ2FtZS5oZWlnaHQgLyAyO1xuXG4gICAgdGhpcy50ZXh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCh4IC0gMzAwLCB5IC0gMjAwLCAnc3BhY2Vmb250JywgXCJDbGljayB0byBTdGFydFwiLCA1MCk7XG4gICAgdGhpcy5zdWJ0aXRsZSA9IHRoaXMuYWRkLmJpdG1hcFRleHQoeCAtIDMwMCwgeSAtIDEwMCwgJ3NwYWNlZm9udCcsIFwiQXJyb3cga2V5cyB0byBtb3ZlLCBTcGFjZSB0byBmaXJlXCIsIDIwKTtcblxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gIH0sXG5cbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7XG4gIH1cbn07XG4iLCJ2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24oZ2FtZSkge1xuICB0aGlzLmFzc2V0ID0gbnVsbDtcbiAgdGhpcy5yZWFkeSA9IGZhbHNlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XG5cblxuUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcblxuICBwcmVsb2FkOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmFzc2V0ID0gdGhpcy5hZGQuc3ByaXRlKDMyMCwgMjQwLCAncHJlbG9hZGVyJyk7XG4gICAgdGhpcy5hc3NldC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuXG4gICAgdGhpcy5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG5cbiAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcbiAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3N0YXJmaWVsZCcsICdhc3NldHMvc3RhcmZpZWxkLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hpcCcsICdhc3NldHMvcGxheWVyLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgncGxhc21hJywgJ2Fzc2V0cy9ibHVlUGxhc21hLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnbGFzZXInLCAnYXNzZXRzL2JsdWVMYXNlci5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2J1bGxldCcsICdhc3NldHMvYmx1ZUJ1bGxldC5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2Ryb25lU2NvdXQnLCAnYXNzZXRzL2Ryb25lU2NvdXQucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdkcm9uZUZpZ2h0ZXInLCAnYXNzZXRzL2Ryb25lRmlnaHRlci5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2Ryb25lQm9tYmVyJywgJ2Fzc2V0cy9kcm9uZUJvbWJlci5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2VuZW15VHJhaWwnLCAnYXNzZXRzL2VuZW15VHJhaWwucG5nJyk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdleHBsb3Npb24nLCAnYXNzZXRzL2V4cGxvc2lvbi5wbmcnLCAxMjgsIDEyOCk7XG4gICAgdGhpcy5sb2FkLmJpdG1hcEZvbnQoJ3NwYWNlZm9udCcsICdhc3NldHMvc3BhY2Vmb250L3NwYWNlZm9udC5wbmcnLCAnYXNzZXRzL3NwYWNlZm9udC9zcGFjZWZvbnQuZm50Jyk7XG4gIH0sXG5cbiAgY3JlYXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmFzc2V0LmNyb3BFbmFibGVkID0gZmFsc2U7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICBpZiAoISF0aGlzLnJlYWR5KSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcbiAgICB9XG4gIH0sXG5cbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICB9XG59OyIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcblxuU3BsYXNoLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gIH1cbn07IiwidmFyIFV0aWxzID0ge1xuICAgIGNvbnRhaW5zT2JqZWN0OiBmdW5jdGlvbihvYmosIGxpc3QpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
